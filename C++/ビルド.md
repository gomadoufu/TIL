# ビルド

ビルドは次の手順で行われる。

1. プリプロセス
2. コンパイル
3. リンク



## プリプロセス

プリプロセスはコンパイル前に行われる前処理のこと。 コメントの削除とプリプロセッサ司令の実行を行う。

`-E` を指定するとプリプロセスだけを行うことができる

```bash
$ g++ -std=c++17 -E main.cc
```



## コンパイル

ソースファイルを機械語に変換した結果はオブジェクトファイルと呼ばれる。 コンパイルだけ実行するには `-c` を指定する。コンパイルはファイルごと。コンパイルだけでは実行ファイルは生成されない

```bash
$ g++ -std=c++11 -c main.cc # -> main.o
$ g++ -std=c++11 -c util.cc # -> util.o
```



## リンク

オブジェクトファイルなどをまとめて実行ファイルを生成することをリンクといいます。 リンクを行うプログラムはリンカという。

`main.o` と `util.o` をリンクして実行ファイルを生成するには次のようにする

```bash
$ g++ -std=c++11 main.o util.o
```

コンパイル時点ではソースファイルを1つずつ処理するため、 ソースファイル内で定義されていない関数や変数に対しては未定義であるという情報がオブジェクトファイルに格納される。
リンクではこうした未定義の関数や変数の定義を他のオブジェクトファイルなどから探して対応付けを行う。