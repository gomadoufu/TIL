# ムーブセマンティクス

大きなデータサイズのオブジェクトをコピーしたいけど、ディープコピーするとメモリ領域が無駄になる
↓
ポインタを使ってシャローコピーすればよい
↓
でもポインタの操作を伴う実装は難しいし、ちゃんと作らないとムーブの仕組みが実現できなくなる
↓
C++11からは、ムーブの考え方を言語仕様として実現しました
→ ムーブセマンティクス (意図されたムーブ って感じかな？)



## 右辺値と左辺値

ムーブにおける重要な概念

- 左辺値: スコープの間生き続ける名前付きのオブジェクト
- 右辺値: リテラルや、関数が返す一時オブジェクトのような、評価された時点で破棄されて不要になるもの

```C++
int x = 300; // x は左辺値。300 のようなリテラルは右辺値。
int y = function(); // y は左辺値。関数 function が返す一時オブジェクトは右辺値。
int z = x; // z と x は左辺値。
```

### 右辺値参照型 T&&

右辺値への参照をスコープの終わりまで生かす(左辺値同様にする)

```C++
int&& r = 1; // 右辺値1を束縛できた！
```



## ムーブの具体的なやり方

ムーブしたい値やオブジェクトを `std::move`で右辺値にキャストしてコピー
→ コンパイラがディープコピーではなくムーブとして処理してくれる

```C++
std::vector<int> x(1000000);
std::vector<int> y = std::move(x); // std::move でキャストすることで、ムーブできる
```

